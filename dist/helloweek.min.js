!function(t){var e={};function s(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/dist",s(s.s=0)}({0:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),s(5);var a=function(){function t(e){void 0===e&&(e={});var s=this;if(this.selectedDays=[],this.options=t.extend(e),this.selector="string"==typeof this.options.selector?document.querySelector(this.options.selector):this.options.selector,null===this.selector)throw new Error("You need to specify a selector!");this.activeDates=null,this.date=this.options.defaultDate?new Date(this.options.defaultDate):new Date,this.todaysDate=this.options.defaultDate?new Date(this.options.defaultDate):new Date,this.month=this.selector.querySelector("."+t.CSS_CLASSES.MONTH),this.week=this.selector.querySelector("."+t.CSS_CLASSES.WEEK),this.label=this.selector.querySelector("."+t.CSS_CLASSES.LABEL),this.readFile(this.options.langFolder+this.options.lang+".json",function(t){s.langs=JSON.parse(t),s.init(function(){})})}return t.prototype.init=function(t){this.date.setDate(1),this.updted(),this.options.onLoad.call(this),t&&t.call(this)},t.prototype.prev=function(t){this.clearCalendar();var e=this.date.getMonth()-1;this.date.setMonth(e),this.updted(),this.options.onChange.call(this),t&&t.call(this)},t.prototype.next=function(t){this.clearCalendar();var e=this.date.getMonth()+1;this.date.setMonth(e),this.updted(),this.options.onChange.call(this),t&&t.call(this)},t.prototype.reset=function(){this.clearCalendar(),this.date=this.options.defaultDate?new Date(this.options.defaultDate):new Date,this.date.setDate(1),this.updted()},t.prototype.selectDay=function(e){var s=this;this.activeDates=this.selector.querySelectorAll("."+t.CSS_CLASSES.IS_ACTIVE);for(var a=0,o=Object.keys(this.activeDates);a<o.length;a++){var i=o[a];this.activeDates[i].addEventListener("click",function(a){var o=a.target;s.options.format?s.lastSelectedDay=s.formatDate(1e3*parseInt(o.dataset.timestamp),s.options.format):s.lastSelectedDay=o.dataset.timestamp,s.options.multiplePick?(s.selectedDays.push(s.lastSelectedDay),a.target.classList.contains(t.CSS_CLASSES.IS_SELECTED)&&(s.selectedDays=s.selectedDays.filter(function(t){return t!==s.lastSelectedDay}))):(a.target.classList.contains(t.CSS_CLASSES.IS_DISABLED)||s.removeActiveClass(),s.selectedDays=[],s.selectedDays.push(s.lastSelectedDay)),a.target.classList.contains(t.CSS_CLASSES.IS_DISABLED)||a.target.classList.toggle(t.CSS_CLASSES.IS_SELECTED),s.options.onSelect.call(s),e&&e.call(s)})}},t.prototype.creatWeek=function(e){var s=document.createElement("span");s.classList.add(t.CSS_CLASSES.WEEK_DAY),s.textContent=e,this.week.appendChild(s)},t.prototype.createMonth=function(){for(var t=this.date.getMonth();this.date.getMonth()===t;)this.createDay(this.date.getDate(),this.date.getDay()),this.date.setDate(this.date.getDate()+1);this.date.setMonth(this.date.getMonth()-1),this.selectDay(function(){})},t.prototype.createDay=function(e,s){var a=this,o=Date.parse(this.date),i=o/1e3,n=document.createElement("div");n.textContent=e,n.classList.add(t.CSS_CLASSES.DAY),n.setAttribute("data-timestamp",i),1===e&&(this.options.weekStart===t.DAYS_WEEK.SUNDAY?n.style.marginLeft=s*(100/7)+"%":s===t.DAYS_WEEK.SUNDAY?n.style.marginLeft=(7-this.options.weekStart)*(100/7)+"%":n.style.marginLeft=100/7*(s-1)+"%"),s!==t.DAYS_WEEK.SUNDAY&&s!==t.DAYS_WEEK.SATURDAY||n.classList.add(t.CSS_CLASSES.IS_WEEKEND),this.options.disabledDaysOfWeek&&this.options.disabledDaysOfWeek.includes(s)&&n.classList.add(t.CSS_CLASSES.IS_DISABLED),this.options.disablePastDays&&this.date.getTime()<=this.todaysDate.getTime()-1||this.options.minDate&&i<=this.options.minDate||this.options.maxDate&&i>=this.options.maxDate?n.classList.add(t.CSS_CLASSES.IS_DISABLED):n.classList.add(t.CSS_CLASSES.IS_ACTIVE),this.options.disableDates&&(this.options.disableDates[0]instanceof Array?this.options.disableDates.map(function(e){a.options.format?o>=new Date(e[0]).getTime()&&o<=new Date(e[1]+" 23:59:59").getTime()&&n.classList.add(t.CSS_CLASSES.IS_DISABLED):o>=e[0]&&o<=e[1]&&n.classList.add(t.CSS_CLASSES.IS_DISABLED)}):this.options.format?this.options.disableDates.includes(this.formatDate(o,this.options.format))&&n.classList.add(t.CSS_CLASSES.IS_DISABLED):(this.options.disableDates.map(function(e){a.formatDate(new Date(o).getTime(),"YYYY-MM-DD")===a.formatDate(new Date(+e).getTime(),"YYYY-MM-DD")&&n.classList.add(t.CSS_CLASSES.IS_DISABLED)}),this.options.disableDates.includes(o.toString())&&n.classList.add(t.CSS_CLASSES.IS_DISABLED))),new Date(this.date).setHours(0,0,0,0)===new Date(this.todaysDate).setHours(0,0,0,0)&&this.options.todayHighlight&&(n.classList.add(t.CSS_CLASSES.IS_TODAY),this.today=i.toString(),this.options.format&&(this.today=this.formatDate(o,this.options.format))),this.options.format?this.selectedDays.find(function(e){e===a.formatDate(o,a.options.format)&&n.classList.toggle(t.CSS_CLASSES.IS_SELECTED)}):this.selectedDays.find(function(e){e===i.toString()&&n.classList.toggle(t.CSS_CLASSES.IS_SELECTED)}),this.month&&this.month.appendChild(n)},t.prototype.monthsAsString=function(t){return this.options.monthShort?this.langs.monthsShort[t]:this.langs.months[t]},t.prototype.weekAsString=function(t){return this.options.weekShort?this.langs.daysShort[t]:this.langs.days[t]},t.prototype.updted=function(){var t=[];this.label.textContent=this.monthsAsString(this.date.getMonth())+" "+this.date.getFullYear();this.options.weekShort?this.langs.daysShort:this.langs.days;this.week.textContent="";for(var e=this.options.weekStart;e<this.langs.daysShort.length;e++)t.push(e);for(e=0;e<this.options.weekStart;e++)t.push(e);for(var s=0,a=t;s<a.length;s++){var o=a[s];this.creatWeek(this.weekAsString(o))}this.createMonth()},t.prototype.clearCalendar=function(){this.month.textContent=""},t.prototype.removeActiveClass=function(){for(var e=0,s=Object.keys(this.activeDates);e<s.length;e++){var a=s[e];this.activeDates[a].classList.remove(t.CSS_CLASSES.IS_SELECTED)}},t.prototype.destroy=function(){this.removeActiveClass()},t.prototype.readFile=function(t,e){var s=new XMLHttpRequest;s.overrideMimeType("application/json"),s.open("GET",t,!0),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&e(s.responseText)},s.send(null)},t.prototype.formatDate=function(t,e){var s=new Date(t);return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("dd",s.getDate().toString())).replace("DD",(s.getDate()>9?s.getDate():"0"+s.getDate()).toString())).replace("mm",(s.getMonth()+1).toString())).replace("MMM",this.langs.months[s.getMonth()])).replace("MM",(s.getMonth()+1>9?s.getMonth()+1:"0"+(s.getMonth()+1)).toString())).replace("mmm",this.langs.monthsShort[s.getMonth()])).replace("yyyy",s.getFullYear().toString())).replace("YYYY",s.getFullYear().toString())).replace("YY",s.getFullYear().toString().substring(2))).replace("yy",s.getFullYear().toString().substring(2))},t.extend=function(t){for(var e={selector:".hello-week",lang:"en",langFolder:"./dist/langs/",format:!1,weekShort:!0,monthShort:!1,multiplePick:!1,defaultDate:!1,todayHighlight:!0,disablePastDays:!1,disabledDaysOfWeek:!1,disableDates:!1,weekStart:0,minDate:!1,maxDate:!1,onLoad:function(){},onChange:function(){},onSelect:function(){}},s=t,a=0,o=Object.keys(s);a<o.length;a++){var i=o[a];e[i]=s[i]}return e},t.CSS_CLASSES={MONTH:"hello-week__month",DAY:"hello-week__day",WEEK:"hello-week__week",WEEK_DAY:"hello-week__week__day",LABEL:"hello-week__label",IS_ACTIVE:"is-active",IS_SELECTED:"is-selected",IS_DISABLED:"is-disabled",IS_TODAY:"is-today",IS_WEEKEND:"is-weekend"},t.DAYS_WEEK={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},t}();e.HelloWeek=a;var o,i=s(0);!function(t){t.HelloWeek=i.HelloWeek}(o=e.MyModule||(e.MyModule={})),window.HelloWeek=o.HelloWeek},5:function(t,e){}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NjcmlwdHMvaGVsbG8td2Vlay50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiSGVsbG9XZWVrIiwib3B0aW9ucyIsIl90aGlzIiwidGhpcyIsInNlbGVjdGVkRGF5cyIsImV4dGVuZCIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiRXJyb3IiLCJhY3RpdmVEYXRlcyIsImRhdGUiLCJkZWZhdWx0RGF0ZSIsIkRhdGUiLCJ0b2RheXNEYXRlIiwibW9udGgiLCJDU1NfQ0xBU1NFUyIsIk1PTlRIIiwid2VlayIsIldFRUsiLCJsYWJlbCIsIkxBQkVMIiwicmVhZEZpbGUiLCJsYW5nRm9sZGVyIiwibGFuZyIsInRleHQiLCJsYW5ncyIsIkpTT04iLCJwYXJzZSIsImluaXQiLCJjYWxsYmFjayIsInNldERhdGUiLCJ1cGR0ZWQiLCJvbkxvYWQiLCJwcmV2IiwiY2xlYXJDYWxlbmRhciIsInByZXZNb250aCIsImdldE1vbnRoIiwic2V0TW9udGgiLCJvbkNoYW5nZSIsIm5leHQiLCJuZXh0TW9udGgiLCJyZXNldCIsInNlbGVjdERheSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJJU19BQ1RJVkUiLCJfaSIsIl9hIiwia2V5cyIsImxlbmd0aCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsImZvcm1hdCIsImxhc3RTZWxlY3RlZERheSIsImZvcm1hdERhdGUiLCJwYXJzZUludCIsImRhdGFzZXQiLCJ0aW1lc3RhbXAiLCJtdWx0aXBsZVBpY2siLCJwdXNoIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJJU19TRUxFQ1RFRCIsImZpbHRlciIsImRheSIsIklTX0RJU0FCTEVEIiwicmVtb3ZlQWN0aXZlQ2xhc3MiLCJ0b2dnbGUiLCJvblNlbGVjdCIsImNyZWF0V2VlayIsImRheVNob3J0Iiwid2Vla0RheSIsImNyZWF0ZUVsZW1lbnQiLCJhZGQiLCJXRUVLX0RBWSIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVNb250aCIsImN1cnJlbnRNb250aCIsImNyZWF0ZURheSIsImdldERhdGUiLCJnZXREYXkiLCJudW0iLCJ1bml4VGltZXN0YW1wIiwibmV3RGF5IiwiREFZIiwic2V0QXR0cmlidXRlIiwid2Vla1N0YXJ0IiwiREFZU19XRUVLIiwiU1VOREFZIiwic3R5bGUiLCJtYXJnaW5MZWZ0IiwiU0FUVVJEQVkiLCJJU19XRUVLRU5EIiwiZGlzYWJsZWREYXlzT2ZXZWVrIiwiaW5jbHVkZXMiLCJkaXNhYmxlUGFzdERheXMiLCJnZXRUaW1lIiwibWluRGF0ZSIsIm1heERhdGUiLCJkaXNhYmxlRGF0ZXMiLCJBcnJheSIsIm1hcCIsInRvU3RyaW5nIiwic2V0SG91cnMiLCJ0b2RheUhpZ2hsaWdodCIsIklTX1RPREFZIiwidG9kYXkiLCJmaW5kIiwibW9udGhzQXNTdHJpbmciLCJtb250aEluZGV4IiwibW9udGhTaG9ydCIsIm1vbnRoc1Nob3J0IiwibW9udGhzIiwid2Vla0FzU3RyaW5nIiwid2Vla0luZGV4Iiwid2Vla1Nob3J0IiwiZGF5c1Nob3J0IiwiZGF5cyIsImxpc3REYXlzIiwiZ2V0RnVsbFllYXIiLCJsaXN0RGF5c18xIiwicmVtb3ZlIiwiZGVzdHJveSIsImZpbGUiLCJ4b2JqIiwiWE1MSHR0cFJlcXVlc3QiLCJvdmVycmlkZU1pbWVUeXBlIiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwb25zZVRleHQiLCJzZW5kIiwiZHQiLCJyZXBsYWNlIiwic3Vic3RyaW5nIiwic2V0dGluZ3MiLCJkZWZhdWx0U2V0dGluZ3MiLCJNT05EQVkiLCJUVUVTREFZIiwiV0VETkVTREFZIiwiVEhVUlNEQVkiLCJGUklEQVkiLCJNeU1vZHVsZSIsImhlbGxvX3dlZWtfMSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBakIsR0FDQVksT0FBQUMsZUFBQWIsRUFBQSxjQUFpRGtCLE9BQUEsS0FJakRwQixFQUFBcUIsRUFBQSxTQUFBbEIsR0FDQSxJQUFBUyxFQUFBVCxLQUFBbUIsV0FDQSxXQUEyQixPQUFBbkIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBSCxFQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQVUsRUFBQUMsR0FBc0QsT0FBQVYsT0FBQVcsVUFBQUMsZUFBQW5CLEtBQUFnQixFQUFBQyxJQUd0RHhCLEVBQUEyQixFQUFBLFFBSUEzQixJQUFBNEIsRUFBQSxxRkNuRUE1QixFQUFB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QUFBeUYsV0FDbkJDLE9BQVksRUFDWmtELE9BQVksRUFDWkMsUUFBWSxFQUNaQyxVQUFZLEVBQ1pDLFNBQVksRUFDWkMsT0FBWSxFQUNabkQsU0FBWSxHQStWcEI3RixFQWpZQSxHQUFhM0IsRUFBQTJCLFlBbVliLElBQ2lCaUosRUFEakJDLEVBQUEvSyxFQUFBLElBQ0EsU0FBaUI4SyxHQUNBQSxFQUFBakosVUFBWWtKLEVBQUFsSixVQUQ3QixDQUFpQmlKLEVBQUE1SyxFQUFBNEssV0FBQTVLLEVBQUE0SyxjQUlYRSxPQUFRbkosVUFBWWlKLEVBQVNqSiIsImZpbGUiOiJoZWxsb3dlZWsubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL2Rpc3RcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0ICcuLi9zdHlsZXMvaGVsbG8td2Vlay5zY3NzJztcblxudHlwZSBDYWxsYmFja0Z1bmN0aW9uID0gKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgSGVsbG9XZWVrIHtcbiAgICBwcml2YXRlIG9wdGlvbnM6IGFueTtcbiAgICBwcml2YXRlIHNlbGVjdG9yOiBhbnk7XG4gICAgcHJpdmF0ZSBtb250aDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB3ZWVrOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGxhYmVsOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGFjdGl2ZURhdGVzOiBhbnk7XG4gICAgcHJpdmF0ZSBkYXRlOiBhbnk7XG4gICAgcHJpdmF0ZSBsYW5nczogYW55O1xuICAgIHByaXZhdGUgdG9kYXlzRGF0ZTogYW55O1xuICAgIHB1YmxpYyB0b2RheTogc3RyaW5nO1xuICAgIHB1YmxpYyBsYXN0U2VsZWN0ZWREYXk6IHN0cmluZztcbiAgICBwdWJsaWMgc2VsZWN0ZWREYXlzOiBhbnkgPSBbXTtcblxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQ1NTX0NMQVNTRVM6IGFueSA9IHtcbiAgICAgICAgTU9OVEggICAgICAgOiAnaGVsbG8td2Vla19fbW9udGgnLFxuICAgICAgICBEQVkgICAgICAgICA6ICdoZWxsby13ZWVrX19kYXknLFxuICAgICAgICBXRUVLICAgICAgICA6ICdoZWxsby13ZWVrX193ZWVrJyxcbiAgICAgICAgV0VFS19EQVkgICAgOiAnaGVsbG8td2Vla19fd2Vla19fZGF5JyxcbiAgICAgICAgTEFCRUwgICAgICAgOiAnaGVsbG8td2Vla19fbGFiZWwnLFxuICAgICAgICBJU19BQ1RJVkUgICA6ICdpcy1hY3RpdmUnLFxuICAgICAgICBJU19TRUxFQ1RFRCA6ICdpcy1zZWxlY3RlZCcsXG4gICAgICAgIElTX0RJU0FCTEVEIDogJ2lzLWRpc2FibGVkJyxcbiAgICAgICAgSVNfVE9EQVkgICAgOiAnaXMtdG9kYXknLFxuICAgICAgICBJU19XRUVLRU5EICA6ICdpcy13ZWVrZW5kJyxcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBEQVlTX1dFRUs6IGFueSA9IHtcbiAgICAgICAgU1VOREFZICAgIDogMCxcbiAgICAgICAgTU9OREFZICAgIDogMSxcbiAgICAgICAgVFVFU0RBWSAgIDogMixcbiAgICAgICAgV0VETkVTREFZIDogMyxcbiAgICAgICAgVEhVUlNEQVkgIDogNCxcbiAgICAgICAgRlJJREFZICAgIDogNSxcbiAgICAgICAgU0FUVVJEQVkgIDogNixcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IgKG9wdGlvbnM6IGFueSA9IHt9KSB7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IEhlbGxvV2Vlay5leHRlbmQob3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RvciA9IHR5cGVvZiB0aGlzLm9wdGlvbnMuc2VsZWN0b3IgPT09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMuc2VsZWN0b3IpIDogdGhpcy5vcHRpb25zLnNlbGVjdG9yO1xuXG4gICAgICAgIC8vIEVhcmx5IHRocm93IGlmIHNlbGVjdG9yIGRvZXNuJ3QgZXhpc3RzXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdG9yID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHNwZWNpZnkgYSBzZWxlY3RvciEnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYWN0aXZlRGF0ZXMgPSBudWxsO1xuICAgICAgICB0aGlzLmRhdGUgPSB0aGlzLm9wdGlvbnMuZGVmYXVsdERhdGUgPyBuZXcgRGF0ZSh0aGlzLm9wdGlvbnMuZGVmYXVsdERhdGUpIDogbmV3IERhdGUoKTtcbiAgICAgICAgdGhpcy50b2RheXNEYXRlID0gdGhpcy5vcHRpb25zLmRlZmF1bHREYXRlID8gbmV3IERhdGUodGhpcy5vcHRpb25zLmRlZmF1bHREYXRlKSA6IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgdGhpcy5tb250aCA9IHRoaXMuc2VsZWN0b3IucXVlcnlTZWxlY3RvcignLicgKyBIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuTU9OVEgpO1xuICAgICAgICB0aGlzLndlZWsgPSB0aGlzLnNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy4nICsgSGVsbG9XZWVrLkNTU19DTEFTU0VTLldFRUspO1xuICAgICAgICB0aGlzLmxhYmVsID0gdGhpcy5zZWxlY3Rvci5xdWVyeVNlbGVjdG9yKCcuJyArIEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5MQUJFTCk7XG5cbiAgICAgICAgdGhpcy5yZWFkRmlsZSh0aGlzLm9wdGlvbnMubGFuZ0ZvbGRlciArIHRoaXMub3B0aW9ucy5sYW5nICsgJy5qc29uJywgKHRleHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sYW5ncyA9IEpTT04ucGFyc2UodGV4dCk7XG4gICAgICAgICAgICB0aGlzLmluaXQoKCkgPT4geyAvKiogY2FsbGJhY2sgZnVuY3Rpb24gKi8gfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxcbiAgICAgKiBAcGFyYW0ge0NhbGxiYWNrRnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICovXG4gICAgcHVibGljIGluaXQoY2FsbGJhY2s6IENhbGxiYWNrRnVuY3Rpb24pIHtcbiAgICAgICAgdGhpcy5kYXRlLnNldERhdGUoMSk7XG4gICAgICAgIHRoaXMudXBkdGVkKCk7XG4gICAgICAgIHRoaXMub3B0aW9ucy5vbkxvYWQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHVibGljIG1ldGhvZFxuICAgICAqIE1ldGhvZCB0byBjaGFuZ2UgdGhlIG1vbnRoIHRvIHRoZSBwcmV2aW91cywgYWxzbyB5b3UgY2FuIHNlbmQgYSBjYWxsYmFjayBmdW5jdGlvbiBsaWtlIGEgcGFyYW1ldGVyLlxuICAgICAqIEBwYXJhbSB7Q2FsbGJhY2tGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICAgKi9cbiAgICBwdWJsaWMgcHJldihjYWxsYmFjazogQ2FsbGJhY2tGdW5jdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmNsZWFyQ2FsZW5kYXIoKTtcbiAgICAgICAgY29uc3QgcHJldk1vbnRoID0gdGhpcy5kYXRlLmdldE1vbnRoKCkgLSAxO1xuICAgICAgICB0aGlzLmRhdGUuc2V0TW9udGgocHJldk1vbnRoKTtcbiAgICAgICAgdGhpcy51cGR0ZWQoKTtcblxuICAgICAgICB0aGlzLm9wdGlvbnMub25DaGFuZ2UuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHVibGljIG1ldGhvZFxuICAgICAqIE1ldGhvZCB0byBjaGFuZ2UgdGhlIG1vbnRoIHRvIHRoZSBuZXh0LCBhbHNvIHlvdSBjYW4gc2VuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uIGxpa2UgYSBwYXJhbWV0ZXIuXG4gICAgICogQHBhcmFtIHtDYWxsYmFja0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgICAqL1xuICAgIHB1YmxpYyBuZXh0KGNhbGxiYWNrOiBDYWxsYmFja0Z1bmN0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2xlYXJDYWxlbmRhcigpO1xuICAgICAgICBjb25zdCBuZXh0TW9udGggPSB0aGlzLmRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIHRoaXMuZGF0ZS5zZXRNb250aChuZXh0TW9udGgpO1xuICAgICAgICB0aGlzLnVwZHRlZCgpO1xuXG4gICAgICAgIHRoaXMub3B0aW9ucy5vbkNoYW5nZS5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQdWJsaWMgbWV0aG9kXG4gICAgICogTWV0aG9kIHRvIGNoYW5nZSB0aGUgbW9udGggdG8gdGhlIG5leHQsIGFsc28geW91IGNhbiBzZW5kIGEgY2FsbGJhY2sgZnVuY3Rpb24gbGlrZSBhIHBhcmFtZXRlci5cbiAgICAgKiBAcGFyYW0ge0NhbGxiYWNrRnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICovXG4gICAgcHVibGljIHJlc2V0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNsZWFyQ2FsZW5kYXIoKTtcbiAgICAgICAgdGhpcy5kYXRlID0gdGhpcy5vcHRpb25zLmRlZmF1bHREYXRlID8gbmV3IERhdGUodGhpcy5vcHRpb25zLmRlZmF1bHREYXRlKSA6IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMuZGF0ZS5zZXREYXRlKDEpO1xuICAgICAgICB0aGlzLnVwZHRlZCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNlbGVjdCBkYXlcbiAgICAgKiBAcGFyYW0ge0NhbGxiYWNrRnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdERheShjYWxsYmFjazogQ2FsbGJhY2tGdW5jdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmFjdGl2ZURhdGVzID0gdGhpcy5zZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19BQ1RJVkUpO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2YgT2JqZWN0LmtleXModGhpcy5hY3RpdmVEYXRlcykpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlRGF0ZXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdERheSA9IGV2ZW50LnRhcmdldDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGUgZm9ybWF0ZWRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0U2VsZWN0ZWREYXkgPSB0aGlzLmZvcm1hdERhdGUocGFyc2VJbnQoc2VsZWN0RGF5LmRhdGFzZXQudGltZXN0YW1wKSAqIDEwMDAsIHRoaXMub3B0aW9ucy5mb3JtYXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGUgaW4gdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFNlbGVjdGVkRGF5ID0gc2VsZWN0RGF5LmRhdGFzZXQudGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGVQaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXlzLnB1c2godGhpcy5sYXN0U2VsZWN0ZWREYXkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfU0VMRUNURUQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF5cyA9IHRoaXMuc2VsZWN0ZWREYXlzLmZpbHRlcigoZGF5OiBzdHJpbmcpID0+IGRheSAhPT0gdGhpcy5sYXN0U2VsZWN0ZWREYXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19ESVNBQkxFRCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQWN0aXZlQ2xhc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF5cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF5cy5wdXNoKHRoaXMubGFzdFNlbGVjdGVkRGF5KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoSGVsbG9XZWVrLkNTU19DTEFTU0VTLklTX0RJU0FCTEVEKSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfU0VMRUNURUQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vblNlbGVjdC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0V2VlayhkYXlTaG9ydDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHdlZWtEYXkgPSA8YW55PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgd2Vla0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5XRUVLX0RBWSk7XG4gICAgICAgIHdlZWtEYXkudGV4dENvbnRlbnQgPSBkYXlTaG9ydDtcbiAgICAgICAgdGhpcy53ZWVrLmFwcGVuZENoaWxkKHdlZWtEYXkpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVNb250aCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY3VycmVudE1vbnRoID0gdGhpcy5kYXRlLmdldE1vbnRoKCk7XG4gICAgICAgIHdoaWxlICh0aGlzLmRhdGUuZ2V0TW9udGgoKSA9PT0gY3VycmVudE1vbnRoKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZURheSh0aGlzLmRhdGUuZ2V0RGF0ZSgpLCB0aGlzLmRhdGUuZ2V0RGF5KCkpO1xuICAgICAgICAgICAgLy8ganVtcCB3aGlsZVxuICAgICAgICAgICAgdGhpcy5kYXRlLnNldERhdGUodGhpcy5kYXRlLmdldERhdGUoKSArIDEpO1xuICAgICAgICB9XG4gICAgICAgIC8vIHB1dCBjb3JyZWN0IG1vbnRoXG4gICAgICAgIHRoaXMuZGF0ZS5zZXRNb250aCh0aGlzLmRhdGUuZ2V0TW9udGgoKSAtIDEpO1xuICAgICAgICB0aGlzLnNlbGVjdERheSgoKSA9PiB7IC8qKiBjYWxsYmFjayBmdW5jdGlvbiAqLyB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgZGF5cyBpbnNpZGUgaGVsbG8td2Vla1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudW1cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGF5XG4gICAgICovXG4gICAgcHVibGljIGNyZWF0ZURheSAobnVtOiBudW1iZXIsIGRheTogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHVuaXhUaW1lc3RhbXAgPSBEYXRlLnBhcnNlKHRoaXMuZGF0ZSk7XG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IHVuaXhUaW1lc3RhbXAgLyAxMDAwO1xuICAgICAgICBjb25zdCBuZXdEYXkgPSA8YW55PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIG5ld0RheS50ZXh0Q29udGVudCA9IG51bTtcbiAgICAgICAgbmV3RGF5LmNsYXNzTGlzdC5hZGQoSGVsbG9XZWVrLkNTU19DTEFTU0VTLkRBWSk7XG4gICAgICAgIG5ld0RheS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGltZXN0YW1wJywgdGltZXN0YW1wKTtcblxuICAgICAgICBpZiAobnVtID09PSAxKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLndlZWtTdGFydCA9PT0gSGVsbG9XZWVrLkRBWVNfV0VFSy5TVU5EQVkpIHtcbiAgICAgICAgICAgICAgICBuZXdEYXkuc3R5bGUubWFyZ2luTGVmdCA9ICgoZGF5KSAqICgxMDAgLyA3KSkgKyAnJSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChkYXkgPT09IEhlbGxvV2Vlay5EQVlTX1dFRUsuU1VOREFZKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0RheS5zdHlsZS5tYXJnaW5MZWZ0ID0gKCg3IC0gdGhpcy5vcHRpb25zLndlZWtTdGFydCkgKiAoMTAwIC8gNykpICsgJyUnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0RheS5zdHlsZS5tYXJnaW5MZWZ0ID0gKChkYXkgLSAxKSAqICgxMDAgLyA3KSkgKyAnJSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRheSA9PT0gSGVsbG9XZWVrLkRBWVNfV0VFSy5TVU5EQVkgfHwgZGF5ID09PSBIZWxsb1dlZWsuREFZU19XRUVLLlNBVFVSREFZKSB7XG4gICAgICAgICAgICBuZXdEYXkuY2xhc3NMaXN0LmFkZChIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfV0VFS0VORCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVkRGF5c09mV2Vlaykge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlZERheXNPZldlZWsuaW5jbHVkZXMoZGF5KSkge1xuICAgICAgICAgICAgICAgIG5ld0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19ESVNBQkxFRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoKHRoaXMub3B0aW9ucy5kaXNhYmxlUGFzdERheXMgJiYgdGhpcy5kYXRlLmdldFRpbWUoKSA8PSB0aGlzLnRvZGF5c0RhdGUuZ2V0VGltZSgpIC0gMSkgfHxcbiAgICAgICAgICAgICh0aGlzLm9wdGlvbnMubWluRGF0ZSAmJiB0aW1lc3RhbXAgPD0gdGhpcy5vcHRpb25zLm1pbkRhdGUpIHx8XG4gICAgICAgICAgICAodGhpcy5vcHRpb25zLm1heERhdGUgJiYgdGltZXN0YW1wID49IHRoaXMub3B0aW9ucy5tYXhEYXRlKSkge1xuICAgICAgICAgICAgbmV3RGF5LmNsYXNzTGlzdC5hZGQoSGVsbG9XZWVrLkNTU19DTEFTU0VTLklTX0RJU0FCTEVEKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19BQ1RJVkUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlRGF0ZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGlzYWJsZURhdGVzWzBdIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMuZGlzYWJsZURhdGVzLm1hcCgoZGF0ZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodW5peFRpbWVzdGFtcCA+PSBuZXcgRGF0ZShkYXRlWzBdKS5nZXRUaW1lKCkgJiYgdW5peFRpbWVzdGFtcCA8PSBuZXcgRGF0ZShkYXRlWzFdICsgJyAyMzo1OTo1OScpLmdldFRpbWUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19ESVNBQkxFRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodW5peFRpbWVzdGFtcCA+PSBkYXRlWzBdICYmIHVuaXhUaW1lc3RhbXAgPD0gZGF0ZVsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19ESVNBQkxFRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlRGF0ZXMuaW5jbHVkZXModGhpcy5mb3JtYXREYXRlKHVuaXhUaW1lc3RhbXAsIHRoaXMub3B0aW9ucy5mb3JtYXQpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF5LmNsYXNzTGlzdC5hZGQoSGVsbG9XZWVrLkNTU19DTEFTU0VTLklTX0RJU0FCTEVEKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kaXNhYmxlRGF0ZXMubWFwKChkYXRlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvcm1hdERhdGUobmV3IERhdGUodW5peFRpbWVzdGFtcCkuZ2V0VGltZSgpLCAnWVlZWS1NTS1ERCcpID09PSB0aGlzLmZvcm1hdERhdGUobmV3IERhdGUoK2RhdGUpLmdldFRpbWUoKSwgJ1lZWVktTU0tREQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RheS5jbGFzc0xpc3QuYWRkKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19ESVNBQkxFRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRpc2FibGVEYXRlcy5pbmNsdWRlcyh1bml4VGltZXN0YW1wLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdEYXkuY2xhc3NMaXN0LmFkZChIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfRElTQUJMRUQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5ldyBEYXRlKHRoaXMuZGF0ZSkuc2V0SG91cnMoMCwwLDAsMCkgPT09IG5ldyBEYXRlKHRoaXMudG9kYXlzRGF0ZSkuc2V0SG91cnMoMCwwLDAsMCkgJiYgdGhpcy5vcHRpb25zLnRvZGF5SGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICBuZXdEYXkuY2xhc3NMaXN0LmFkZChIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfVE9EQVkpO1xuICAgICAgICAgICAgdGhpcy50b2RheSA9IHRpbWVzdGFtcC50b1N0cmluZygpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZGF5ID0gdGhpcy5mb3JtYXREYXRlKHVuaXhUaW1lc3RhbXAsIHRoaXMub3B0aW9ucy5mb3JtYXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mb3JtYXQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXlzLmZpbmQoIChkYXk6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkYXkgPT09IHRoaXMuZm9ybWF0RGF0ZSh1bml4VGltZXN0YW1wLCB0aGlzLm9wdGlvbnMuZm9ybWF0KSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdEYXkuY2xhc3NMaXN0LnRvZ2dsZShIZWxsb1dlZWsuQ1NTX0NMQVNTRVMuSVNfU0VMRUNURUQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERheXMuZmluZCggKGRheTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRheSA9PT0gdGltZXN0YW1wLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF5LmNsYXNzTGlzdC50b2dnbGUoSGVsbG9XZWVrLkNTU19DTEFTU0VTLklTX1NFTEVDVEVEKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm1vbnRoKSB7XG4gICAgICAgICAgICB0aGlzLm1vbnRoLmFwcGVuZENoaWxkKG5ld0RheSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgbW9udGhzQXNTdHJpbmcobW9udGhJbmRleDogYW55KTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5tb250aFNob3J0ID8gdGhpcy5sYW5ncy5tb250aHNTaG9ydFttb250aEluZGV4XSA6IHRoaXMubGFuZ3MubW9udGhzW21vbnRoSW5kZXhdO1xuICAgIH1cblxuICAgIHB1YmxpYyB3ZWVrQXNTdHJpbmcod2Vla0luZGV4OiBhbnkpOiBhbnkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLndlZWtTaG9ydCA/IHRoaXMubGFuZ3MuZGF5c1Nob3J0W3dlZWtJbmRleF0gOiB0aGlzLmxhbmdzLmRheXNbd2Vla0luZGV4XTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkdGVkKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBsaXN0RGF5czogbnVtYmVyW10gPSBbXTtcblxuICAgICAgICB0aGlzLmxhYmVsLnRleHRDb250ZW50ID0gdGhpcy5tb250aHNBc1N0cmluZyh0aGlzLmRhdGUuZ2V0TW9udGgoKSkgKyAnICcgKyB0aGlzLmRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgLyoqIERlZmluZSB3ZWVrIGZvcm1hdCAqL1xuICAgICAgICBjb25zdCB3ZWVrRm9ybWF0ID0gdGhpcy5vcHRpb25zLndlZWtTaG9ydCA/IHRoaXMubGFuZ3MuZGF5c1Nob3J0IDogdGhpcy5sYW5ncy5kYXlzO1xuICAgICAgICB0aGlzLndlZWsudGV4dENvbnRlbnQgPSAnJztcblxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5vcHRpb25zLndlZWtTdGFydDsgaSA8IHRoaXMubGFuZ3MuZGF5c1Nob3J0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsaXN0RGF5cy5wdXNoKGkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9wdGlvbnMud2Vla1N0YXJ0OyBpKyspIHtcbiAgICAgICAgICAgIGxpc3REYXlzLnB1c2goaSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IGRheSBvZiBsaXN0RGF5cykge1xuICAgICAgICAgICAgdGhpcy5jcmVhdFdlZWsodGhpcy53ZWVrQXNTdHJpbmcoZGF5KSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNyZWF0ZU1vbnRoKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyQ2FsZW5kYXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubW9udGgudGV4dENvbnRlbnQgPSAnJztcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVtb3ZlQWN0aXZlQ2xhc3MoKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBPYmplY3Qua2V5cyh0aGlzLmFjdGl2ZURhdGVzKSkge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVEYXRlc1tpXS5jbGFzc0xpc3QucmVtb3ZlKEhlbGxvV2Vlay5DU1NfQ0xBU1NFUy5JU19TRUxFQ1RFRCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZW1vdmVBY3RpdmVDbGFzcygpO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWFkRmlsZShmaWxlOiBzdHJpbmcsIGNhbGxiYWNrOiBDYWxsYmFja0Z1bmN0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHhvYmogPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeG9iai5vdmVycmlkZU1pbWVUeXBlKCdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgIHhvYmoub3BlbignR0VUJywgZmlsZSwgdHJ1ZSk7XG4gICAgICAgIHhvYmoub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHhvYmoucmVhZHlTdGF0ZSA9PT0gNCAmJiA8YW55PnhvYmouc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh4b2JqLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHhvYmouc2VuZChudWxsKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZm9ybWF0RGF0ZSh0aW1lc3RhbXA6IG51bWJlciwgZm9ybWF0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBkdCA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCdkZCcsIGR0LmdldERhdGUoKS50b1N0cmluZygpKTtcbiAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoJ0REJywgKGR0LmdldERhdGUoKSA+IDkgPyBkdC5nZXREYXRlKCkgOiAnMCcgKyBkdC5nZXREYXRlKCkpLnRvU3RyaW5nKCkpO1xuICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnbW0nLCAoZHQuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkpO1xuICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnTU1NJywgdGhpcy5sYW5ncy5tb250aHNbZHQuZ2V0TW9udGgoKV0pO1xuICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnTU0nLCAoKGR0LmdldE1vbnRoKCkgKyAxKSA+IDkgPyAoZHQuZ2V0TW9udGgoKSArIDEpIDogJzAnICsgKGR0LmdldE1vbnRoKCkgKyAxKSkudG9TdHJpbmcoKSk7XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCdtbW0nLCB0aGlzLmxhbmdzLm1vbnRoc1Nob3J0W2R0LmdldE1vbnRoKCldKTtcbiAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoJ3l5eXknLCBkdC5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpO1xuICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnWVlZWScsIGR0LmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSk7XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCdZWScsIChkdC5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpLnN1YnN0cmluZygyKSk7XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCd5eScsIChkdC5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpLnN1YnN0cmluZygyKSk7XG4gICAgICAgIHJldHVybiBmb3JtYXQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgZXh0ZW5kKG9wdGlvbnM6IENhbGxiYWNrRnVuY3Rpb24pOiBvYmplY3Qge1xuICAgICAgICBjb25zdCBzZXR0aW5nczogYW55ID0ge1xuICAgICAgICAgICAgc2VsZWN0b3I6ICcuaGVsbG8td2VlaycsXG4gICAgICAgICAgICBsYW5nOiAnZW4nLFxuICAgICAgICAgICAgbGFuZ0ZvbGRlcjogJy4vZGlzdC9sYW5ncy8nLFxuICAgICAgICAgICAgZm9ybWF0OiBmYWxzZSxcbiAgICAgICAgICAgIHdlZWtTaG9ydDogdHJ1ZSxcbiAgICAgICAgICAgIG1vbnRoU2hvcnQ6IGZhbHNlLFxuICAgICAgICAgICAgbXVsdGlwbGVQaWNrOiBmYWxzZSxcbiAgICAgICAgICAgIGRlZmF1bHREYXRlOiBmYWxzZSxcbiAgICAgICAgICAgIHRvZGF5SGlnaGxpZ2h0OiB0cnVlLFxuICAgICAgICAgICAgZGlzYWJsZVBhc3REYXlzOiBmYWxzZSxcbiAgICAgICAgICAgIGRpc2FibGVkRGF5c09mV2VlazogZmFsc2UsXG4gICAgICAgICAgICBkaXNhYmxlRGF0ZXM6IGZhbHNlLFxuICAgICAgICAgICAgd2Vla1N0YXJ0OiAwLFxuICAgICAgICAgICAgbWluRGF0ZTogZmFsc2UsXG4gICAgICAgICAgICBtYXhEYXRlOiBmYWxzZSxcbiAgICAgICAgICAgIG9uTG9hZDogKCkgPT4geyAvKiogY2FsbGJhY2sgZnVuY3Rpb24gKi8gfSxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiAoKSA9PiB7IC8qKiBjYWxsYmFjayBmdW5jdGlvbiAqLyB9LFxuICAgICAgICAgICAgb25TZWxlY3Q6ICgpID0+IHsgLyoqIGNhbGxiYWNrIGZ1bmN0aW9uICovIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZGVmYXVsdFNldHRpbmdzID0gPGFueT5vcHRpb25zO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2YgT2JqZWN0LmtleXMoZGVmYXVsdFNldHRpbmdzKSkge1xuICAgICAgICAgICAgc2V0dGluZ3NbaV0gPSBkZWZhdWx0U2V0dGluZ3NbaV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2V0dGluZ3M7XG4gICAgfVxufVxuXG5pbXBvcnQgeyBIZWxsb1dlZWsgYXMgTXlIZWxsb1dlZWsgfSBmcm9tICcuL2hlbGxvLXdlZWsnO1xuZXhwb3J0IG5hbWVzcGFjZSBNeU1vZHVsZSB7XG4gICAgZXhwb3J0IGNvbnN0IEhlbGxvV2VlayA9IE15SGVsbG9XZWVrO1xufVxuXG4oPGFueT53aW5kb3cpLkhlbGxvV2VlayA9IE15TW9kdWxlLkhlbGxvV2VlaztcbiJdLCJzb3VyY2VSb290IjoiIn0=